import streamlit as st
import pandas as pd

# è¯»å–Excelæ•°æ®ï¼ˆå’Œæ–‡ä»¶åŒç›®å½•ï¼Œæ— éœ€æ”¹è·¯å¾„ï¼‰
df = pd.read_excel("ä¼ä¸šæ•°å­—åŒ–è½¬å‹æŒ‡æ•°ç»“æœ.xlsx", usecols=["è‚¡ç¥¨ä»£ç ", "ä¼ä¸šåç§°", "æ•°å­—åŒ–è½¬å‹æŒ‡æ•°", "å¹´ä»½"])
df["è‚¡ç¥¨ä»£ç "] = df["è‚¡ç¥¨ä»£ç "].astype(str)  # é¿å…æ•°å­—/å­—ç¬¦ä¸²åŒ¹é…é”™è¯¯
latest_year = df["å¹´ä»½"].max()

# å‰ç«¯æŸ¥è¯¢ç•Œé¢
st.title("ä¼ä¸šæ•°å­—åŒ–è½¬å‹æŒ‡æ•°æŸ¥è¯¢")
stock_code = st.text_input("è¯·è¾“å…¥è‚¡ç¥¨ä»£ç ï¼ˆå¦‚600000ï¼‰")

if st.button("æŸ¥è¯¢"):
    if not stock_code:
        st.warning("è¯·è¾“å…¥è‚¡ç¥¨ä»£ç ï¼")
    else:
        result = df[df["è‚¡ç¥¨ä»£ç "] == stock_code.strip()]
        if len(result) == 0:
            st.error("æœªæ‰¾åˆ°è¯¥è‚¡ç¥¨ä»£ç çš„æ•°æ®ï¼")
        else:
            st.success(f"æŸ¥è¯¢æˆåŠŸï¼ˆ{latest_year}å¹´æ•°æ®ï¼‰")
            st.write("ğŸ“Œ è‚¡ç¥¨ä»£ç ï¼š", result.iloc[0]["è‚¡ç¥¨ä»£ç "])
            st.write("ğŸ¢ ä¼ä¸šåç§°ï¼š", result.iloc[0]["ä¼ä¸šåç§°"])
            st.write("ğŸ“Š æ•°å­—åŒ–è½¬å‹æŒ‡æ•°ï¼š", round(result.iloc[0]["æ•°å­—åŒ–è½¬å‹æŒ‡æ•°"], 2))